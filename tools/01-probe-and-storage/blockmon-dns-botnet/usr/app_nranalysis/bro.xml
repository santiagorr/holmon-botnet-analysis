<composition id="dns_stage1">
  <general>
    <clock type="wall" />
  </general>

  <install>
    <threadpool id="src_thread" num_threads="1"/>
    
    <block id="src" type="DNSMappingSource" invocation="async" threadpool="src_thread">
      <params>
        <file name="/home/bht/dnsmappings.txt"/>
      </params>
    </block>

    <block id="mapfilter" type="DNSMappingFilter" invocation="direct"> 
      <params>
        <complete_flush val = "3600"/>
        <table_memory val = "600"/>
        <qname_analysis val = "false"/>
        <time_align val = "true"/>
      </params>
    </block>

    <block id="analyzer" type="DNSMappingAnalyzer" invocation="direct"> 
      <params>
          <time_bin_split_merge val = "21600"/>
          <time_bin_cleanup val = "43200"/>
          <time_bin_printout val = "60"/>
          <suspicious_file val = "/home/bht/dns_trace/out/suspicious.txt"/>
          <dump_file val = "/home/bht/dns_trace/out/dump_"/>
          <load_file val = "/home/bht/dns_trace/out/load.txt"/>
          <load_config val = "false"/>
          <tld_names_file val = "/home/bht/dns_trace/data/effective_tld_names.dat"/>
          <geoip_file val = "/home/bht/dns_trace/data/GeoIPASNum.dat"/>
          <max_cluster_size val = "50"/>
          <max_num_clusters val = "50"/>
          <clustering_threshold val = "0.4"/>
          <domain_count_threshold val = "0.5"/>
      </params>
    </block>

    <connection src_block="src" src_gate="source_out" dst_block="mapfilter" dst_gate="in"/>
    <connection src_block="mapfilter" src_gate="out" dst_block="analyzer" dst_gate="in_pkt"/>

  </install>
</composition>
