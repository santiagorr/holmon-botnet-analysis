<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>blockmon: blockmon::Flow Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">blockmon
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceblockmon.html">blockmon</a></li><li class="navelem"><a class="el" href="classblockmon_1_1Flow.html">Flow</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classblockmon_1_1Flow-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">blockmon::Flow Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="Flow_8hpp_source.html">Flow.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for blockmon::Flow:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classblockmon_1_1Flow.png" usemap="#blockmon::Flow_map" alt=""/>
  <map id="blockmon::Flow_map" name="blockmon::Flow_map">
<area href="classblockmon_1_1Msg.html" alt="blockmon::Msg" shape="rect" coords="0,0,98,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a39d4aab4f14161289b7e51864802b399"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Flow.html#a39d4aab4f14161289b7e51864802b399">Flow</a> (const <a class="el" href="structblockmon_1_1FlowKey.html">FlowKey</a> &amp;key)</td></tr>
<tr class="memitem:aaafc7eb56e0679dbb1504f470988092c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaafc7eb56e0679dbb1504f470988092c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Flow</b> (const <a class="el" href="structblockmon_1_1FlowKey.html">FlowKey</a> &amp;key, <a class="el" href="namespaceblockmon.html#aa2f671ebca3ac8590af2f68c591c4212">ustime_t</a> stime, <a class="el" href="namespaceblockmon.html#aa2f671ebca3ac8590af2f68c591c4212">ustime_t</a> etime, uint64_t bytes, uint64_t packets)</td></tr>
<tr class="memitem:a0b593e70a8d0705eec5d2a79aa330849"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0b593e70a8d0705eec5d2a79aa330849"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Flow</b> (const <a class="el" href="structblockmon_1_1FlowKey.html">FlowKey</a> &amp;key, <a class="el" href="namespaceblockmon.html#aa2f671ebca3ac8590af2f68c591c4212">ustime_t</a> stime, <a class="el" href="namespaceblockmon.html#aa2f671ebca3ac8590af2f68c591c4212">ustime_t</a> etime, uint64_t bytes, uint64_t packets, std::list&lt; std::shared_ptr&lt; const <a class="el" href="classblockmon_1_1Packet.html">Packet</a> &gt; &gt; packet_list, bool list_sorted)</td></tr>
<tr class="memitem:afb3781f363991051e9d7c2993dad57d2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afb3781f363991051e9d7c2993dad57d2"></a>
const <a class="el" href="structblockmon_1_1FlowKey.html">FlowKey</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>key</b> () const </td></tr>
<tr class="memitem:abde93c0c504bd4cfc5c21d618b57c2f8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abde93c0c504bd4cfc5c21d618b57c2f8"></a>
<a class="el" href="namespaceblockmon.html#aa2f671ebca3ac8590af2f68c591c4212">ustime_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>start_time</b> () const </td></tr>
<tr class="memitem:a17a6f7d8d776c4fbcd1c5c70e7f90569"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a17a6f7d8d776c4fbcd1c5c70e7f90569"></a>
<a class="el" href="namespaceblockmon.html#aa2f671ebca3ac8590af2f68c591c4212">ustime_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>end_time</b> () const </td></tr>
<tr class="memitem:aa4296f64c78c6bbcd06e1c2863558151"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa4296f64c78c6bbcd06e1c2863558151"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>expand_interval</b> (<a class="el" href="namespaceblockmon.html#aa2f671ebca3ac8590af2f68c591c4212">ustime_t</a> us)</td></tr>
<tr class="memitem:aa4f19ed0b3310b3694a91b9521bf163b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa4f19ed0b3310b3694a91b9521bf163b"></a>
uint64_t&#160;</td><td class="memItemRight" valign="bottom"><b>bytes</b> () const </td></tr>
<tr class="memitem:a87aa3ba2ed1ca5677c48dc28db0993b0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a87aa3ba2ed1ca5677c48dc28db0993b0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>increment_bytes</b> (uint64_t val)</td></tr>
<tr class="memitem:a21c303efecdb9b74ffc5683374030a17"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a21c303efecdb9b74ffc5683374030a17"></a>
uint64_t&#160;</td><td class="memItemRight" valign="bottom"><b>packets</b> () const </td></tr>
<tr class="memitem:a796dbbc75037b42e7179887b618aae57"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a796dbbc75037b42e7179887b618aae57"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>increment_packets</b> (uint64_t val)</td></tr>
<tr class="memitem:a9930b51872bca1743b2485c013000a13"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9930b51872bca1743b2485c013000a13"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>matches</b> (const <a class="el" href="classblockmon_1_1Packet.html">Packet</a> &amp;p)</td></tr>
<tr class="memitem:a08bca9a11549ca88b67f0c308f8e0a81"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a08bca9a11549ca88b67f0c308f8e0a81"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>matches</b> (const <a class="el" href="classblockmon_1_1Flow.html">Flow</a> &amp;f)</td></tr>
<tr class="memitem:aa6a2cef61332a9174bdddd1acd79319f"><td class="memItemLeft" align="right" valign="top">virtual std::shared_ptr&lt; <a class="el" href="classblockmon_1_1Msg.html">Msg</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Flow.html#aa6a2cef61332a9174bdddd1acd79319f">clone</a> () const </td></tr>
<tr class="memitem:ae9de4b4da36c7bd227013c7e24c04b5a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae9de4b4da36c7bd227013c7e24c04b5a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>reset</b> ()</td></tr>
<tr class="memitem:a10a205b4594897c7cf1b9ffff49267d4"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Flow.html#a10a205b4594897c7cf1b9ffff49267d4">get_payload</a> (uint8_t *buffer, size_t offset, size_t nbytes)</td></tr>
<tr class="memitem:a955c7520f9870c7dbb4e8972a89ca7e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Flow.html#a955c7520f9870c7dbb4e8972a89ca7e4">add_packet</a> (std::shared_ptr&lt; const <a class="el" href="classblockmon_1_1Packet.html">Packet</a> &gt; p)</td></tr>
<tr class="inherit_header pub_methods_classblockmon_1_1Msg"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classblockmon_1_1Msg')"><img src="closed.png" alt="-"/>&nbsp;Public Member Functions inherited from <a class="el" href="classblockmon_1_1Msg.html">blockmon::Msg</a></td></tr>
<tr class="memitem:ac6f054c17c168f45438e226e99d8325f inherit pub_methods_classblockmon_1_1Msg"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Msg.html#ac6f054c17c168f45438e226e99d8325f">Msg</a> (int msg_id, <a class="el" href="structblockmon_1_1mutable__buffer.html">mutable_buffer</a>&lt; char &gt; buf=<a class="el" href="structblockmon_1_1mutable__buffer.html">mutable_buffer</a>&lt; char &gt;(), bool ownership=false)</td></tr>
<tr class="memitem:afd77ed2cdf5039f18f452e6ff2ce8126 inherit pub_methods_classblockmon_1_1Msg"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Msg.html#afd77ed2cdf5039f18f452e6ff2ce8126">~Msg</a> ()</td></tr>
<tr class="memitem:a5ca19a3744409e4f8301209a605f2221 inherit pub_methods_classblockmon_1_1Msg"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Msg.html#a5ca19a3744409e4f8301209a605f2221">get_message_name</a> () const </td></tr>
<tr class="memitem:a012528dfb441a5b60ce1deb9a689f41c inherit pub_methods_classblockmon_1_1Msg"><td class="memItemLeft" align="right" valign="top">virtual const std::shared_ptr<br class="typebreak"/>
&lt; <a class="el" href="classblockmon_1_1Msg.html">Msg</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Msg.html#a012528dfb441a5b60ce1deb9a689f41c">build_same</a> (<a class="el" href="classblockmon_1_1Serializer.html">Serializer</a> *ser) const </td></tr>
<tr class="memitem:a9ec126bfbd26270bdc1b6010439a2a73 inherit pub_methods_classblockmon_1_1Msg"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Msg.html#a9ec126bfbd26270bdc1b6010439a2a73">serialize</a> (<a class="el" href="classblockmon_1_1Serializer.html">Serializer</a> *ser) const </td></tr>
<tr class="memitem:a50e09ef5f8390d4fbe74379848447ca7 inherit pub_methods_classblockmon_1_1Msg"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Msg.html#a50e09ef5f8390d4fbe74379848447ca7">set_tagbuf</a> (<a class="el" href="structblockmon_1_1mutable__buffer.html">mutable_buffer</a>&lt; char &gt; buf, bool ownership)</td></tr>
<tr class="memitem:aea6aa652e88d77a223e1a292431d22ec inherit pub_methods_classblockmon_1_1Msg"><td class="memTemplParams" colspan="2">template&lt;typename Tag , typename MsgType , typename... Ts&gt; </td></tr>
<tr class="memitem:aea6aa652e88d77a223e1a292431d22ec"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Msg.html#aea6aa652e88d77a223e1a292431d22ec">emplace_tag</a> (<a class="el" href="structblockmon_1_1tag__handle.html">tag_handle</a>&lt; MsgType &gt; handle, Ts &amp;&amp;...args) const </td></tr>
<tr class="memitem:a6ec70d44153938bcef08aad79a35178d inherit pub_methods_classblockmon_1_1Msg"><td class="memTemplParams" colspan="2">template&lt;typename Tag , typename MsgType &gt; </td></tr>
<tr class="memitem:a6ec70d44153938bcef08aad79a35178d"><td class="memTemplItemLeft" align="right" valign="top">const Tag *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Msg.html#a6ec70d44153938bcef08aad79a35178d">get_tag</a> (<a class="el" href="structblockmon_1_1tag__handle.html">tag_handle</a>&lt; MsgType &gt; handle) const </td></tr>
<tr class="memitem:a015012702fdb6d21fc1f5e0a06607f91 inherit pub_methods_classblockmon_1_1Msg"><td class="memTemplParams" colspan="2">template&lt;typename MsgType &gt; </td></tr>
<tr class="memitem:a015012702fdb6d21fc1f5e0a06607f91"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Msg.html#a015012702fdb6d21fc1f5e0a06607f91">is_available_tag</a> (<a class="el" href="structblockmon_1_1tag__handle.html">tag_handle</a>&lt; MsgType &gt; handle) const </td></tr>
<tr class="memitem:ab4b26ff95455544b800097e244d01624 inherit pub_methods_classblockmon_1_1Msg"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Msg.html#ab4b26ff95455544b800097e244d01624">swap</a> (<a class="el" href="classblockmon_1_1Msg.html">Msg</a> &amp;rhs)</td></tr>
<tr class="memitem:acc837c5a0b66b8fc7d06eb45ad26ea18 inherit pub_methods_classblockmon_1_1Msg"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Msg.html#acc837c5a0b66b8fc7d06eb45ad26ea18">type</a> () const </td></tr>
<tr class="memitem:ac8c82611a56d6648f9f9260887638769 inherit pub_methods_classblockmon_1_1Msg"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classblockmon_1_1Msg.html#ac8c82611a56d6648f9f9260887638769">pod_copy</a> (<a class="el" href="structblockmon_1_1mutable__buffer.html">mutable_buffer</a>&lt; uint8_t &gt;) const </td></tr>
<tr class="memitem:a5321bf4ea323ab19853154782dce036d inherit pub_methods_classblockmon_1_1Msg"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5321bf4ea323ab19853154782dce036d"></a>
virtual size_t&#160;</td><td class="memItemRight" valign="bottom"><b>pod_size</b> () const </td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ab8c33786b150a732998433a2d564cf21"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab8c33786b150a732998433a2d564cf21"></a>
<a class="el" href="namespaceblockmon.html#aa2f671ebca3ac8590af2f68c591c4212">ustime_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>m_stime</b></td></tr>
<tr class="memitem:a8865f05fc1fd8cdedb8a9d17d4bd86ca"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8865f05fc1fd8cdedb8a9d17d4bd86ca"></a>
<a class="el" href="namespaceblockmon.html#aa2f671ebca3ac8590af2f68c591c4212">ustime_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>m_etime</b></td></tr>
<tr class="memitem:a102551330f06c06f1acc8d8ba28ae087"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a102551330f06c06f1acc8d8ba28ae087"></a>
<a class="el" href="structblockmon_1_1FlowKey.html">FlowKey</a>&#160;</td><td class="memItemRight" valign="bottom"><b>m_key</b></td></tr>
<tr class="memitem:ad9ec356da78ce83613f858eaaa7ffc51"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad9ec356da78ce83613f858eaaa7ffc51"></a>
uint64_t&#160;</td><td class="memItemRight" valign="bottom"><b>m_bytes</b></td></tr>
<tr class="memitem:a6497be4f61c4da197b363230ad6cb9e4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6497be4f61c4da197b363230ad6cb9e4"></a>
uint64_t&#160;</td><td class="memItemRight" valign="bottom"><b>m_packets</b></td></tr>
<tr class="memitem:aba6e7e6ce0f7475dd9656e853db52b58"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aba6e7e6ce0f7475dd9656e853db52b58"></a>
std::list&lt; std::shared_ptr<br class="typebreak"/>
&lt; const <a class="el" href="classblockmon_1_1Packet.html">Packet</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_flow_packets</b></td></tr>
<tr class="memitem:a0c09b7757410b359b93b3d8af9082eef"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0c09b7757410b359b93b3d8af9082eef"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>m_list_sorted</b></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classblockmon_1_1Msg"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classblockmon_1_1Msg')"><img src="closed.png" alt="-"/>&nbsp;Protected Member Functions inherited from <a class="el" href="classblockmon_1_1Msg.html">blockmon::Msg</a></td></tr>
<tr class="memitem:a86ecc73016aaaec34c4a1dc1269f3fe8 inherit pro_methods_classblockmon_1_1Msg"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a86ecc73016aaaec34c4a1dc1269f3fe8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>assert_pod_size</b> (size_t len) const </td></tr>
<tr class="memitem:a17ff0e99d20eeb37a8dca410846d4794 inherit pro_methods_classblockmon_1_1Msg"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a17ff0e99d20eeb37a8dca410846d4794"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Msg</b> (<a class="el" href="classblockmon_1_1Msg.html">Msg</a> const &amp;other)</td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Provides a the information regarding a flow.</p>
<p>this includes start and end time, packets and bytes count, the flow five-tuple as well as a buffer with reassembled data </p>

<p>Definition at line <a class="el" href="Flow_8hpp_source.html#l00054">54</a> of file <a class="el" href="Flow_8hpp_source.html">Flow.hpp</a>.</p>
</div><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a39d4aab4f14161289b7e51864802b399"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">blockmon::Flow::Flow </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structblockmon_1_1FlowKey.html">FlowKey</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>regular constructor </p>

<p>Definition at line <a class="el" href="Flow_8hpp_source.html#l00060">60</a> of file <a class="el" href="Flow_8hpp_source.html">Flow.hpp</a>.</p>

</div>
</div>
<h2>Member Function Documentation</h2>
<a class="anchor" id="a955c7520f9870c7dbb4e8972a89ca7e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void blockmon::Flow::add_packet </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; const <a class="el" href="classblockmon_1_1Packet.html">Packet</a> &gt;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds the packet to the flow.</p>
<p>This can later be used for <a class="el" href="classblockmon_1_1Flow.html#a10a205b4594897c7cf1b9ffff49267d4">get_payload()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>the packet to add </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Flow_8cpp_source.html#l00220">220</a> of file <a class="el" href="Flow_8cpp_source.html">Flow.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa6a2cef61332a9174bdddd1acd79319f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::shared_ptr&lt;<a class="el" href="classblockmon_1_1Msg.html">Msg</a>&gt; blockmon::Flow::clone </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>*returns a copy of the message (which always owns its buffer) </p>

<p>Reimplemented from <a class="el" href="classblockmon_1_1Msg.html#aadffcd5e16cd1e17176bbc0c6dd8823a">blockmon::Msg</a>.</p>

<p>Definition at line <a class="el" href="Flow_8hpp_source.html#l00155">155</a> of file <a class="el" href="Flow_8hpp_source.html">Flow.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a10a205b4594897c7cf1b9ffff49267d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t blockmon::Flow::get_payload </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nbytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the payload from this flow.</p>
<p>Copies the payload contained in the packets in this flow into <em>buffer</em>, starting at byte offset <em>offset</em> and continuing for <em>size</em> bytes.</p>
<p>This method does not deal with fragmented packets, so it is strongly advised that if you plan to call this method on a flow, you put a Nodefrag block before the input gate, or perhaps a block (not written at this time) that does packet defragmentation.</p>
<p>The normal case is when this flow is a TCP flow that contains all packets. In this case, the result is as if</p>
<ul>
<li>the packets constituting this flow had been sorted into increasing TCP sequence number;</li>
<li>the payloads of the packets in the sorted list laid end to end in a buffer <em>p</em> of length ; and</li>
<li>if <em>offset</em> + <em>length</em> &lt;= <em>l</em>, bytes <em>p</em> + <em>offset</em> through <em>p</em> + <em>nbytes</em> - 1 will be copied, otherwise bytes <em>p</em> + <em>offset</em> through <em>p</em> +  - 1 will be copied, and the number of bytes copies will be zero if <em>offset</em> &gt;= <em>l</em>.</li>
</ul>
<p>In case that not all packets constituting a TCP flow have actually been added to the flow (i.e., if the flow has "holes"), copying is as before but stops just before the first "hole" byte. This may lead to no bytes being copied at all.</p>
<p>In case of a UDP flow packet, copying always starts at offset zero, no matter what the value of <em>offset</em> is.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>the buffer in which to copy the payload </td></tr>
    <tr><td class="paramname">offset</td><td>the offset in the payload from where to start copying </td></tr>
    <tr><td class="paramname">nbytes</td><td>the maximum number of payload bytes to copy</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the number of bytes copied. This will always be less than or equal to <em>length</em>. </dd></dl>

<p>Definition at line <a class="el" href="Flow_8cpp_source.html#l00036">36</a> of file <a class="el" href="Flow_8cpp_source.html">Flow.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/santiago/src/blockmon-compile-a-la-upstream/blockmon-0.827872f/messages/<a class="el" href="Flow_8hpp_source.html">Flow.hpp</a></li>
<li>/home/santiago/src/blockmon-compile-a-la-upstream/blockmon-0.827872f/messages/<a class="el" href="Flow_8cpp_source.html">Flow.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 2 2013 17:48:35 for blockmon by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
